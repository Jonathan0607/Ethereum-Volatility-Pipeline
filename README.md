# Ethereum Volatility & Market Regime Detector

## Overview

A hybrid quantitative finance pipeline designed to forecast Ethereum volatility and classify market risk regimes in real-time. By combining statistical methods (GARCH) with deep learning (LSTMs) and unsupervised clustering (GMM), this system provides actionable risk signals that outperform standard Buy-and-Hold strategies.


## ðŸ“ˆ Visual Proof of Performance

### 1. Market Regime Detection (Unsupervised Learning)
*The Gaussian Mixture Model (GMM) successfully clusters market behavior into "Stable" (Green) and "High Volatility" (Red) regimes without being explicitly programmed to find crashes.*

![Market Regime Clusters](regime_plot.png)

### 2. Strategy Backtest (Financial Engineering)
*The regime-based trading strategy (Blue) avoids major drawdowns during high-volatility periods, significantly outperforming the Buy-and-Hold benchmark (Gray).*

![Backtest Performance](backtest_results.png)

---

## ðŸš€ Key Features

* **Hybrid Architecture:** Integrates **GARCH** (Generalized Autoregressive Conditional Heteroskedasticity) variance features into an **LSTM** (Long Short-Term Memory) network to capture both linear and non-linear market dependencies.
* **Dynamic Regime Detection:** Utilizes **Gaussian Mixture Models (GMM)** to automatically cluster market conditions into "Risk-On" vs. "Risk-Off" states.
* **Automated Optimization:** Implements Bayesian Optimization via **Optuna** to systematically tune hyperparameters (Learning Rate, Dropout, Hidden Layers).
* **Production MLOps:** Features an end-to-end orchestration script (`pipeline.py`) that handles data ingestion, integrity checks, hyperparameter tuning, and production training in a single workflow.

---

## ðŸ“Š Performance Metrics

### Financial Performance (Backtest)
| Metric | Benchmark (Buy & Hold) | Regime Strategy (Ours) |
| :--- | :--- | :--- |
| **Total Return** | 1.47% | **4.47%** |
| **Sharpe Ratio** | ~0.50 | **1.38** (Institutional Grade) |
| **Max Drawdown** | High | **-14.22%** (Capital Preserved) |

### Model Optimization (Optuna)
* **Baseline Loss:** `1.39`
* **Optimized Loss:** `0.034` (**~97% Improvement**)
* **Winning Config:** LSTM (128 units), 2 Layers, Dropout 0.25, LR 0.0007.

---

## ðŸ“‚ Project Structure

This project follows a modular "Senior Engineer" architecture, separating logic into dedicated modules.

```bash
â”œâ”€â”€ data/
â”‚   â””â”€â”€ eth_hourly.csv      # Processed data (Generated by fetch_data.py)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ fetch_data.py       # Connects to Kraken API to download OHLCV data
â”‚   â”œâ”€â”€ process_data.py     # Data integrity checks (NaNs, Sorting, Types) & Cleaning
â”‚   â”œâ”€â”€ features.py         # Feature Engineering: GARCH Volatility & Log Returns
â”‚   â”œâ”€â”€ regimes.py          # Unsupervised Learning: GMM Logic for Market Clustering
â”‚   â”œâ”€â”€ model.py            # PyTorch LSTM Architecture Class Definition
â”‚   â”œâ”€â”€ tune.py             # Bayesian Optimization (Optuna) for hyperparameter search
â”‚   â”œâ”€â”€ train.py            # LSTM Training Loop with Early Stopping & Checkpointing
â”‚   â”œâ”€â”€ visualize.py        # Generates the Regime Plots and Loss Curves
â”‚   â”œâ”€â”€ backtest.py         # Strategy simulator (Sharpe Ratio, Max Drawdown calculation)
â”‚   â””â”€â”€ pipeline.py         # MLOps Orchestrator: Runs the full workflow end-to-end
â”œâ”€â”€ best_params.txt         # Output file storing the best hyperparameters found
â”œâ”€â”€ lstm_model.pth          # Saved PyTorch model artifacts
â”œâ”€â”€ regime_plot.png         # Visualization of GMM Market Clusters
â”œâ”€â”€ backtest_results.png    # Performance chart (Strategy vs. Buy & Hold)
â””â”€â”€ requirements.txt        # Python dependencies
