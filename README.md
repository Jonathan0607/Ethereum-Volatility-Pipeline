# Ethereum Volatility & Market Regime Detector

## Overview

A hybrid machine learning pipeline designed to forecast Ethereum volatility and classify market risk regimes in real-time. By combining statistical methods (GARCH) with deep learning (LSTMs) and unsupervised clustering (GMM), this system provides actionable risk signals for algorithmic trading strategies.

## ğŸš€ Key Features

* **Hybrid Architecture:** Integrates **GARCH** (Generalized Autoregressive Conditional Heteroskedasticity) variance features into an **LSTM** (Long Short-Term Memory) network to capture both linear and non-linear market dependencies.
* **Dynamic Regime Detection:** Utilizes **Gaussian Mixture Models (GMM)** to automatically cluster market conditions into "Stable" vs. "High Volatility" regimes, enabling dynamic risk-off/risk-on logic.
* **Automated Optimization:** Implements Bayesian Optimization via **Optuna** to systematically tune hyperparameters (Learning Rate, Dropout, Hidden Layers), reducing validation loss by **~97%** compared to baseline models.
* **Robust MLOps Pipeline:** Features an end-to-end orchestration script (`pipeline.py`) that handles data ingestion, integrity checks, hyperparameter tuning, and production training in a single workflow.
* **Quantitative Backtesting:** Includes a strategy simulator that calculates Sharpe Ratio and Max Drawdown to validate the model's economic performance against a Buy-and-Hold benchmark.

## ğŸ› ï¸ Tech Stack

* **Core:** Python 3.10+, Pandas, NumPy
* **Deep Learning:** PyTorch (MPS/CUDA support enabled)
* **Statistical Modeling:** Arch (GARCH), Scikit-Learn (GMM, Scalers)
* **Optimization:** Optuna
* **Visualization:** Matplotlib, Seaborn

## ğŸ“Š Performance & Optimization

The model architecture was optimized using `Optuna` to maximize predictive accuracy on unseen validation data.

* **Optimization Method:** Bayesian Search (TPE Sampler)
* **Search Space:**
    * Learning Rate: `1e-4` to `1e-2` (Log scale)
    * Hidden Dimensions: `[32, 64, 128]`
    * Dropout: `0.1` to `0.5`
* **Results:**
    * *Baseline Loss:* `1.39`
    * *Optimized Loss:* **`0.034`**
    * *Best Config:* Single-layer LSTM (128 units) with moderate dropout (`0.25`) proved most robust against overfitting.

## ğŸ“‚ Project Structure

```bash
â”œâ”€â”€ data/
â”‚   â””â”€â”€ eth_hourly.csv      # Processed data (Generated by fetch_data.py)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ fetch_data.py       # Connects to Kraken API to download OHLCV data
â”‚   â”œâ”€â”€ process_data.py     # Data integrity checks (NaNs, Sorting, Types) & Cleaning
â”‚   â”œâ”€â”€ features.py         # Feature Engineering: GARCH Volatility & Log Returns
â”‚   â”œâ”€â”€ regimes.py          # Unsupervised Learning: GMM Logic for Market Clustering
â”‚   â”œâ”€â”€ model.py            # PyTorch LSTM Architecture Class Definition
â”‚   â”œâ”€â”€ tune.py             # Bayesian Optimization (Optuna) for hyperparameter search
â”‚   â”œâ”€â”€ train.py            # LSTM Training Loop with Early Stopping & Checkpointing
â”‚   â”œâ”€â”€ visualize.py        # Generates Loss Curves, Regime plots, and Prediction charts
â”‚   â”œâ”€â”€ backtest.py         # Strategy simulator (Sharpe Ratio, Max Drawdown calculation)
â”‚   â””â”€â”€ pipeline.py         # MLOps Orchestrator: Runs the full workflow end-to-end
â”œâ”€â”€ best_params.txt         # Output file storing the best hyperparameters found
â”œâ”€â”€ lstm_model.pth          # Saved PyTorch model artifacts
â”œâ”€â”€ regime_plot.png         # Visualization of GMM Market Clusters
â”œâ”€â”€ backtest_results.png    # Performance chart (Strategy vs. Buy & Hold)
â””â”€â”€ requirements.txt        # Python dependencies